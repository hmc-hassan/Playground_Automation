{"version":3,"file":"utils.js","names":["hostname","dirname","extname","join","env","pid","fileURLToPath","isMainThread","threadId","LabelName","filename","import","meta","url","getSuitesOfMochaTest","test","titlePath","slice","resolveParallelModeSetupFile","concat","resolveMochaWorkerId","_env$MOCHA_WORKER_ID","MOCHA_WORKER_ID","toString","allureHostName","ALLURE_HOST_NAME","getHostLabel","name","HOST","value","getWorkerIdLabel","THREAD","getInitialLabels","LANGUAGE","FRAMEWORK"],"sources":["../../src/utils.ts"],"sourcesContent":["import type * as Mocha from \"mocha\";\nimport { hostname } from \"node:os\";\nimport { dirname, extname, join } from \"node:path\";\nimport { env, pid } from \"node:process\";\nimport { fileURLToPath } from \"node:url\";\nimport { isMainThread, threadId } from \"node:worker_threads\";\nimport type { Label } from \"allure-js-commons\";\nimport { LabelName } from \"allure-js-commons\";\n\nconst filename = fileURLToPath(import.meta.url);\n\nexport const getSuitesOfMochaTest = (test: Mocha.Test) => test.titlePath().slice(0, -1);\n\nexport const resolveParallelModeSetupFile = () =>\n  join(dirname(filename), `setupAllureMochaParallel${extname(filename)}`);\n\nexport const resolveMochaWorkerId = () => env.MOCHA_WORKER_ID ?? (isMainThread ? pid : threadId).toString();\n\nconst allureHostName = env.ALLURE_HOST_NAME || hostname();\n\nexport const getHostLabel = (): Label => ({\n  name: LabelName.HOST,\n  value: allureHostName,\n});\n\nexport const getWorkerIdLabel = (): Label => ({\n  name: LabelName.THREAD,\n  value: resolveMochaWorkerId(),\n});\n\nexport const getInitialLabels = (): Label[] => [\n  { name: LabelName.LANGUAGE, value: \"javascript\" },\n  { name: LabelName.FRAMEWORK, value: \"mocha\" },\n  getHostLabel(),\n  getWorkerIdLabel(),\n];\n"],"mappings":"AACA,SAASA,QAAQ,QAAQ,SAAS;AAClC,SAASC,OAAO,EAAEC,OAAO,EAAEC,IAAI,QAAQ,WAAW;AAClD,SAASC,GAAG,EAAEC,GAAG,QAAQ,cAAc;AACvC,SAASC,aAAa,QAAQ,UAAU;AACxC,SAASC,YAAY,EAAEC,QAAQ,QAAQ,qBAAqB;AAE5D,SAASC,SAAS,QAAQ,mBAAmB;AAE7C,IAAMC,QAAQ,GAAGJ,aAAa,CAACK,MAAM,CAACC,IAAI,CAACC,GAAG,CAAC;AAE/C,OAAO,IAAMC,oBAAoB,GAAIC,IAAgB,IAAKA,IAAI,CAACC,SAAS,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AAEvF,OAAO,IAAMC,4BAA4B,GAAGA,CAAA,KAC1Cf,IAAI,CAACF,OAAO,CAACS,QAAQ,CAAC,6BAAAS,MAAA,CAA6BjB,OAAO,CAACQ,QAAQ,CAAC,CAAE,CAAC;AAEzE,OAAO,IAAMU,oBAAoB,GAAGA,CAAA;EAAA,IAAAC,oBAAA;EAAA,QAAAA,oBAAA,GAAMjB,GAAG,CAACkB,eAAe,cAAAD,oBAAA,cAAAA,oBAAA,GAAI,CAACd,YAAY,GAAGF,GAAG,GAAGG,QAAQ,EAAEe,QAAQ,CAAC,CAAC;AAAA;AAE3G,IAAMC,cAAc,GAAGpB,GAAG,CAACqB,gBAAgB,IAAIzB,QAAQ,CAAC,CAAC;AAEzD,OAAO,IAAM0B,YAAY,GAAGA,CAAA,MAAc;EACxCC,IAAI,EAAElB,SAAS,CAACmB,IAAI;EACpBC,KAAK,EAAEL;AACT,CAAC,CAAC;AAEF,OAAO,IAAMM,gBAAgB,GAAGA,CAAA,MAAc;EAC5CH,IAAI,EAAElB,SAAS,CAACsB,MAAM;EACtBF,KAAK,EAAET,oBAAoB,CAAC;AAC9B,CAAC,CAAC;AAEF,OAAO,IAAMY,gBAAgB,GAAGA,CAAA,KAAe,CAC7C;EAAEL,IAAI,EAAElB,SAAS,CAACwB,QAAQ;EAAEJ,KAAK,EAAE;AAAa,CAAC,EACjD;EAAEF,IAAI,EAAElB,SAAS,CAACyB,SAAS;EAAEL,KAAK,EAAE;AAAQ,CAAC,EAC7CH,YAAY,CAAC,CAAC,EACdI,gBAAgB,CAAC,CAAC,CACnB","ignoreList":[]}